# =============================================================================
# EZY Portal - External Infrastructure Configuration
# =============================================================================
# Use this template when connecting to existing PostgreSQL, Redis, RabbitMQ
# services (docker-compose.portal-only.yml)
# =============================================================================

INFRASTRUCTURE_MODE=external
VERSION=latest
PROJECT_NAME=ezy-portal

# -----------------------------------------------------------------------------
# [CONFIGURE] DATABASE (Your existing PostgreSQL)
# -----------------------------------------------------------------------------
POSTGRES_HOST=your-postgres-host
POSTGRES_PORT=5432
POSTGRES_DB=portal
POSTGRES_USER=postgres
# POSTGRES_PASSWORD is in portal.secrets.env
# ConnectionStrings__DefaultConnection is in portal.secrets.env

# -----------------------------------------------------------------------------
# [CONFIGURE] REDIS (Your existing Redis)
# -----------------------------------------------------------------------------
REDIS_HOST=your-redis-host
REDIS_PORT=6379
# REDIS_PASSWORD=your-redis-password
ConnectionStrings__Redis=your-redis-host:6379
# With password: ConnectionStrings__Redis=your-redis-host:6379,password=your-password

# -----------------------------------------------------------------------------
# [CONFIGURE] RABBITMQ (Your existing RabbitMQ - Optional)
# -----------------------------------------------------------------------------
RabbitMq__Enabled=false
# RabbitMq__Enabled=true
# RabbitMq__Host=your-rabbitmq-host
# RabbitMq__Port=5672
# RabbitMq__User=portal
# RabbitMq__Password goes in portal.secrets.env
# RabbitMq__VirtualHost=/

# -----------------------------------------------------------------------------
# [CONFIGURE] ADMIN & APPLICATION
# -----------------------------------------------------------------------------
ADMIN_EMAIL=admin@yourcompany.com
APPLICATION_URL=https://portal.yourcompany.com
FRONTEND_URL=https://portal.yourcompany.com
CORS_ALLOWED_ORIGINS=https://portal.yourcompany.com
SERVER_NAME=portal.yourcompany.com

# -----------------------------------------------------------------------------
# DEPLOYMENT MODE (Configured by wizard)
# -----------------------------------------------------------------------------
SINGLE_TENANT_MODE=true
DEFAULT_TENANT_NAME="Your Organization"
DEFAULT_TENANT_SUBDOMAIN=app
SINGLE_TENANT_EXTERNAL_ACCOUNTS_ENABLED=false
ACCOUNT_LINKING_MODE=Standalone

# -----------------------------------------------------------------------------
# [CONFIGURE] AUTHENTICATION
# -----------------------------------------------------------------------------
ALLOW_LOCAL_LOGIN=false

# Azure AD
AZURE_AD_TENANT_ID=
AZURE_AD_CLIENT_ID=
AZURE_AD_CLIENT_SECRET=
AZURE_AD_ALLOWED_DOMAIN=

# Google OAuth
GOOGLE_CLIENT_ID=
GOOGLE_CLIENT_SECRET=
GOOGLE_ALLOWED_DOMAIN=

# -----------------------------------------------------------------------------
# EMAIL (Optional)
# -----------------------------------------------------------------------------
Email__ServiceType=SMTP
Email__SmtpHost=
Email__SmtpPort=587
Email__Username=
Email__Password=
Email__UseSsl=true
Email__FromName=Portal
Email__FromAddress=

# -----------------------------------------------------------------------------
# DEFAULTS (Usually don't need to change)
# -----------------------------------------------------------------------------
STORAGE_DRIVER=Local
FILE_STORAGE_LOCAL_PATH=/app/uploads
Frontend__AppTitle=Portal
Frontend__DefaultLanguage=en
Frontend__MultiLanguageEnabled=false
Frontend__ShowTestWatermark=false
Frontend__Features__DarkModeEnabled=true
ADVANCED_SEARCH_ENABLED=true
Localization__DefaultLanguage=en-US
Localization__DefaultTimeZone=America/Panama
Serilog__MinimumLevel__Default=Warning
LOG_FILE_PATH=/app/logs/log-.txt
ASPNETCORE_ENVIRONMENT=Production
ASPNETCORE_URLS=http://+:8080
HEALTH_CHECKS_ENABLED=true
HEALTH_CHECKS_PATH=/health
Hangfire__EnableDashboard=true
Hangfire__DashboardUrl=/hangfire

# -----------------------------------------------------------------------------
# CLAMAV ANTIVIRUS SCANNER (Optional - SEC-09)
# -----------------------------------------------------------------------------
# Real-time virus scanning for file uploads
# Requires ~1GB RAM and ~500MB disk for virus signatures
CLAMAV_ENABLED=false
CLAMAV_HOST=clamav
CLAMAV_PORT=3310
# Set to true to allow uploads when ClamAV is unavailable (NOT recommended)
# CLAMAV_FAIL_OPEN=false

# -----------------------------------------------------------------------------
# SESSION POLICY (SEC-36)
# -----------------------------------------------------------------------------
# Session cookie lifetime in hours (default: 8, ISO 27002: 4)
SESSION_COOKIE_HOURS=8
# Refresh token lifetime in days (default: 7, ISO 27002: 1)
REFRESH_TOKEN_DAYS=7
# Idle timeout in minutes (0 = disabled). ISO 27002 requires 30.
SESSION_IDLE_TIMEOUT_MINUTES=0

# -----------------------------------------------------------------------------
# REPORT GENERATOR (Optional)
# -----------------------------------------------------------------------------
# Install with: ./add-report-generator.sh api|service|all
# Email settings above (Email__*) are automatically used for report delivery.
# REPORT_GENERATOR_VERSION=latest
# Customer database credentials (add as needed per report):
# CUSTOMER_DB_HOST=db.customer.com
# CUSTOMER_DB_NAME=customer_db
# CUSTOMER_DB_USER=report_user
# CUSTOMER_DB_PASSWORD=secret
